说明文档

1. 概述：
   本软件是一个用于获取已经打开的 Excel 文档，并提取其中的数据进行筛选和可视化展示的工具。用户可以通过软件界面实现快捷的数据筛选和可视化效果，同时还支持将筛选结果通过邮件发送。

2. 技术栈：
   - 编程语言：Python
   - GUI 库：Tkinter
   - 数据处理库：Pandas
   - Excel 操作库：xlwings
   - 邮件发送库：smtplib

3. 功能：
   - 获取已打开的 Excel 文档：通过 `get_excel` 函数获取当前打开的 Excel 文件的工作簿对象，并获取工作簿中的所有工作表名称。
   - 选择工作表：通过下拉列表选择要操作的工作表，并将选择的工作表存储在 `worksheet` 变量中。
   - 数据筛选：通过选择负责人下拉列表中的选项，调用 `get_principal` 函数对数据进行筛选，并将筛选结果显示在表格中。
   - 邮件发送：通过选择邮件地址下拉列表中的选项，调用 `email_sent_button_event` 函数将筛选结果以附件形式发送至选定的邮件地址。
   - 表格展示：使用 `ttk.Treeview` 组件创建表格，展示筛选结果，并支持滚动浏览。
   - 数据导出：将筛选结果以 Excel 格式导出，保存为 "List of unfinished projects.xlsx" 文件。

4. 界面布局：
   - 窗口标题：Tracking List Tool
   - 上方框架：
     - 获取 Excel 文件按钮：点击按钮触发 `get_excel` 函数，获取当前打开的 Excel 文件。
     - 工作表下拉列表：用于选择要操作的工作表。
     - 获取选择的工作表按钮：点击按钮触发 `get_selected_sheet` 函数，获取选择的工作表。
     - 负责人下拉列表：用于选择要筛选的负责人。
     - 查询按钮：点击按钮触发 `get_principal` 函数，对数据进行筛选。
     - 邮件地址下拉列表：用于选择邮件发送的接收地址。
     - 发送邮件按钮：点击按钮触发 `email_sent_button_event` 函数，将筛选结果发送至选定的邮件地址。
   - 表格展示：使用 `ttk.Treeview` 组件展示筛选结果，并支持垂直滚动。
   - 滚动条：用于控制表格的垂直滚动。
   - 窗口大小：窗口大小设置为 1920x1080。

5. 数据处理：
   - 获取 Excel 数据：通过 xlwings 库获取当前打开的 Excel 文件的工作簿对象，然后获取工作簿中的所有工作表名称。
   - 筛选数据：使用正则表达式对负责人列进行筛选，将符合条件的数据添加到表格中进行展示。
   - 表格展示：使用 ttk.Treeview 组件创建表格，并将筛选结果显示在表格中，支持水平和垂直滚动。
   - 数据导出：使用 pandas 库将筛选结果导出为 Excel 文件，保存为 "List of unfinished projects.xlsx"。

6. 邮件发送：
   - 邮件配置：需要配置发件人的邮箱地址和密码。
   - 获取邮件地址：从下拉列表中选择要发送邮件的接收地址。
   - 邮件发送：使用 smtplib 和 email.mime 库发送邮件，将筛选结果作为附件发送给选定的邮件地址。


以下是对代码的框架说明：

1. 导入所需的库和模块：
   - `datetime`：处理日期和时间相关操作的模块。
   - `re`：用于正则表达式匹配的模块。
   - `smtplib`、`email.mime.application`、`email.mime.multipart`：用于发送电子邮件的相关模块和类。
   - `pandas`：用于数据处理和分析的库。
   - `tkinter`、`tkinter.messagebox`、`tkinter.ttk`：用于创建 GUI 界面的模块和类。
   - `xlwings`：与 Excel 交互的库。

2. 创建窗口和设置窗口标题。

3. 定义获取 Excel 文件的函数 `get_excel()`：
   - 通过 `xlwings` 获取当前打开的 Excel 文件的工作簿对象。
   - 验证文件名是否为 "EE_Task_Tracking_List.xlsx"，否则显示错误提示。
   - 获取工作簿中的所有工作表名称，并将其显示在下拉列表框中。

4. 创建下拉列表框和按钮：
   - `combo_box3`：用于选择工作表。
   - `get_selected_sheet()`：获取选择的工作表，并显示提示信息。

5. 创建负责人下拉列表框和查询按钮：
   - `combo_box`：用于选择负责人名称。
   - `get_principal()`：根据选择的负责人名称进行数据筛选。

6. 创建邮件地址下拉列表框和发送邮件按钮：
   - `combo_box1`：用于选择邮件地址。
   - `email_sent_button_event()`：发送邮件给选择的邮件地址。

7. 创建表格和滚动条：
   - `result_table`：用于显示筛选结果的表格。
   - 设置表格的样式和列属性。
   - 绑定表格的编辑事件（未启用）。

8. 定义数据筛选函数 `filter_data(search_text)`：
   - 使用正则表达式模式匹配筛选文本。
   - 从 Excel 中读取数据，并迭代筛选符合条件的行。
   - 将筛选结果插入到表格中。
   - 处理数据的处理和特殊情况。

9. 定义发送邮件函数 `send_email(receiver_email)`：
   - 设置 SMTP 服务器的主机名和端口号。
   - 创建邮件对象，并设置发件人、收件人、主题等信息。
   - 附加待发送的文件。

以上是代码的主要框架和功能说明。通过 GUI 界面用户可以选择要打开的 Excel 文件、工作表、负责人、邮件地址，并进行数据筛选和邮件发送操作。筛选结果将显示在表格中，并可保存为 Excel 文件。
